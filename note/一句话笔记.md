# 一句话笔记

-----

> 这里汇集一句话描绘有意思的事情....

## Zookeeper

> 服务于分布式系统，可以做 ***统一配置管理***、***统一命名服务***、***分布式锁***、***集群管理*** 。
> 
> 一句话描述就是：基于 ***`监听 + Znode节点(持久/临时 * 普通/有序)`*** 变换玩转。

- 数据结构

> 跟Unix文件系统非常类似，可以看做是一颗树，每个节点叫做 `ZNode`，每一个节点可以通过路径来标识，如：“/”、“/java/zk”。
> 
> 节点类型：
> 
>> ***临时(Ephemeral)***：当客户端和服务端断开连接后，所创建的Znode(节点)会自动删除 <br>
>> ***持久(Persistent)***：当客户端和服务端断开连接后，所创建的Znode(节点)不会删除
>>> 每个节点也分 `普通节点` 和 `有序节点`

- 监听器

> 监听Znode节点的 **数据变化** <br>
> 监听子节点的 **增减变化**

- 使用

> 统一配置管理
>> 多个系统将公共的配置文件维护到 ZK 的指定 ZNode，系统监听这个节点来同步配置的变更
>
> 统一命名服务
>> 一个域名对用多个IP，将域名和IP的关系维护到 ZK 的指定 ZNode，用户就可以通过域名访问资源了
>
> 分布式锁
>> 多个应用系统都访问 ZK 的 `/locks`（可以是其他） 节点，并创建 ***带顺序号的临时（EPHEMERAL_SEQUENTIAL）*** 节点，每个系统获得 /locks 下所有子节点，判断自己创建的是不是 ***最小*** 的那个节点，如果是，获得锁；如果不是，则监听比自己要小 `1` 的节点变化；
>>> 释放锁：执行完操作后，把创建的节点给删掉
>
> 集群管理
>> 集群中的成员都访问 ZK 的 `/groupMember`（可以是其他） 节点，并创建 ***临时节点***，通过监听 /groupMember 节点下的子节点，感知成员上下线。
>>> 动态选举 master，将 Znode 节点类型改成 ***带顺序号的临时节点***，ZK 会每次选举最小编号的作为 master。